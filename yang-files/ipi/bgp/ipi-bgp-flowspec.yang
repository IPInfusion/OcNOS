/*
* Copyright (C) 2019 IP Infusion, Inc.
*  All Rights Reserved.
*
*** Auto generated by zebmdc

* Unless required by applicable law or agreed to in writing,
* software distributed under the License is distributed on an
* "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
* KIND, either express or implied.

* File name : ipi-bgp-flowspec.yang
*
*/

submodule ipi-bgp-flowspec {

    yang-version 1.1;

    belongs-to  ipi-bgp { prefix ipi-bgp; }

    import feature-list {
        prefix feature-list;
        revision-date 2023-11-04;
    }

    import ipi-bgp-flowspec-types {
        prefix ipi-bgp-flowspec-types;
        revision-date 2023-02-28;
    }

    import ipi-enhanced-pbr-types {
        prefix ipi-enhanced-pbr-types;
        revision-date 2023-02-28;
    }

    organization
        "IP Infusion Inc.";

    contact
        "Address: 3965 Freedom Circle, Suite 200, Santa Clara, CA 95054
         Phone: +1 408-400-1900
         E-mail: support@ipinfusion.com
         Web: http://www.ipinfusion.com/";

    description
        "BGP FLow Specification (FLOWSPEC)";


    revision "2023-03-12" {
        description "packet-length attribute corrections";
        reference " 0.1.3.";
    }

    revision "2023-03-08" {
        description "db-sync issue correction";
        reference " 0.1.2.";
    }

    revision "2023-02-28" {
        description "split class-map/policy-map configuration to enhanced-pbr.xml";
        reference " 0.1.1.";
    }

    revision "2023-01-23" {
        description "Initial Version";
        reference " 0.1.0.";
    }

    grouping flowspec-controller-config {
        description
            "grouping for FLOWSPEC controller config";
        leaf enable-flowspec-controller  {
            type  empty;
            description "Use this attribute to controllersly enable or disable FLOWSPEC
                        controller";
        } // END of enable-flowspec-controller definition.

        leaf local-install  {
            type  ipi-bgp-flowspec-types:flowspec_local_install_t;
            default "interface-all";
            description "Use this attribute to specify local-install for policy-map PBR";
        } // END of local-install definition.

    } // END of flowspec-controller-config definition.
    grouping flowspec-default-vrf_address-family-config {
        description
            "grouping for FLOWSPEC default vrf address-family config";
        leaf afi-type  {
            type  ipi-bgp-flowspec-types:flowspec_afi_type_t;
            description "specify an address-family";
        } // END of afi-type definition.

        leaf local-install  {
            type  ipi-bgp-flowspec-types:flowspec_local_install_t;
            default "interface-all";
            description "Use this attribute to specify local-install for policy-map PBR";
        } // END of local-install definition.

    } // END of flowspec-default-vrf_address-family-config definition.
    grouping flowspec-default_vrf_service_policy-config {
        description
            "grouping for FLOWSPEC default vrf service-policy config";
        leaf attached-policy-map-name  {
            type  string {
                length "1..1965";
                pattern "[^?' =,>|]+";
            }
            description "Use this attribute to specify attached-policy-map-name";
        } // END of attached-policy-map-name definition.

        leaf service-policy-type  {
            type  ipi-enhanced-pbr-types:epbr_policy_map_t;
            description "Use this attribute to specify service-policy-type";
        } // END of service-policy-type definition.

    } // END of flowspec-default_vrf_service_policy-config definition.
    grouping flowspec-vrf-config {
        description
            "grouping for FLOWSPEC vrf config";
        leaf vrf-name  {
            type  string {
                length "1..1965";
                pattern "[^?' =,>|]+";
            }
            description "Use this attribute to show the vrf name";
        } // END of vrf-name definition.

        leaf local-install  {
            type  ipi-bgp-flowspec-types:flowspec_local_install_t;
            default "interface-all";
            description "Use this attribute to specify local-install for policy-map PBR";
        } // END of local-install definition.

    } // END of flowspec-vrf-config definition.
    grouping flowspec-vrf-address-family_config {
        description
            "grouping for FLOWSPEC vrf address-family config";
        leaf afi-type  {
            type  ipi-bgp-flowspec-types:flowspec_afi_type_t;
            description "specify afi type for an address-family";
        } // END of afi-type definition.

        leaf local-install  {
            type  ipi-bgp-flowspec-types:flowspec_local_install_t;
            default "interface-all";
            description "Use this attribute to specify local-install for policy-map PBR";
        } // END of local-install definition.

    } // END of flowspec-vrf-address-family_config definition.
    grouping flowspec-vrf-service-policy_config {
        description
            "grouping for FLOWSPEC vrf service-policy config";
        leaf attached-policy-map-name  {
            type  string {
                length "1..1965";
                pattern "[^?' =,>|]+";
            }
            description "Use this attribute to specify attached-policy-map-name";
        } // END of attached-policy-map-name definition.

        leaf service-policy-type  {
            type  ipi-enhanced-pbr-types:epbr_policy_map_t;
            description "Use this attribute to specify service-policy-type";
        } // END of service-policy-type definition.

    } // END of flowspec-vrf-service-policy_config definition.
    grouping flowspec-top {
        description
            "Top-level grouping for FLOWSPEC";

        list controller {
            key "enable-flowspec-controller";
            description
                "Configuration data for FLOWSPEC";
            leaf enable-flowspec-controller  {
                type  leafref {
                    path  "../config/enable-flowspec-controller";
                }
                description "Use this attribute to controllersly enable or disable FLOWSPEC
                            controller";
            } // END of enable-flowspec-controller definition.

            container config {
                description
                    "Configuration data for FLOWSPEC";
                uses flowspec-controller-config;
            } // END of config-container definition.
            container state {
                config false;
                description
                    "Operational state data for class for FLOWSPEC controller";
                uses flowspec-controller-config;
            } // END of state-container definition.
            container address-families {
                description
                    "Configuration data for address family of FLOWSPEC";

                list address-family {
                    key "afi-type";
                    description
                        "configuring address-family";
                    leaf afi-type  {
                        type  leafref {
                            path  "../config/afi-type";
                        }
                        description "specify AFI_TYPE for an address-family";
                    } // END of afi-type definition.


                    list service-policy {
                        key "attached-policy-map-name service-policy-type";
                        description
                            "Attach service-policy for BGP_FLOWSPEC";
                        leaf attached-policy-map-name  {
                            type  leafref {
                                path  "../config/attached-policy-map-name";
                            }
                            description "Use this attribute to specify attached-policy-map-name";
                        } // END of attached-policy-map-name definition.

                        leaf service-policy-type  {
                            type  leafref {
                                path  "../config/service-policy-type";
                            }
                            description "Use this attribute to specify service-policy-type";
                        } // END of service-policy-type definition.

                        container config {
                            description
                                "config";
                            uses flowspec-default_vrf_service_policy-config;
                        } // END of config-container definition.
                        container state {
                            config false;
                            description
                                "Operational state data for class for FLOWSPEC default vrf
                                        address-family";
                            uses flowspec-default_vrf_service_policy-config;
                        } // END of state-container definition.
                    } // End of service-policy-list
                    container config {
                        description
                            "configuring for address-family";
                        uses flowspec-default-vrf_address-family-config;
                    } // END of config-container definition.
                    container state {
                        config false;
                        description
                            "Operational state data for class for FLOWSPEC default vrf
                                    address-family";
                        uses flowspec-default-vrf_address-family-config;
                    } // END of state-container definition.
                } // End of address-family-list
            } // END of address-families-container definition.
            container vrfs {
                description
                    "Configuration data for vrfs of FLOWSPEC";

                list vrf {
                    key "vrf-name";
                    description
                        "Configuratoin data list for BGP_FLOWSPEC VRF";
                    leaf vrf-name  {
                        type  leafref {
                            path  "../config/vrf-name";
                        }
                        description "Use this attribute to show the vrf name";
                    } // END of vrf-name definition.

                    container config {
                        description
                            "config";
                        uses flowspec-vrf-config;
                    } // END of config-container definition.
                    container state {
                        config false;
                        description
                            "Operational state data for FLOWSPEC default vrf config";
                        uses flowspec-vrf-config;
                    } // END of state-container definition.
                    container address-families {
                        description
                            "configuring address-families";

                        list address-family {
                            key "afi-type";
                            description
                                "configuring address-family";
                            leaf afi-type  {
                                type  leafref {
                                    path  "../config/afi-type";
                                }
                                description "specify afi type for an address-family";
                            } // END of afi-type definition.


                            list service-policy {
                                key "attached-policy-map-name service-policy-type";
                                description
                                    "Attach service-policy for BGP_FLOWSPEC";
                                leaf attached-policy-map-name  {
                                    type  leafref {
                                        path  "../config/attached-policy-map-name";
                                    }
                                    description "Use this attribute to specify attached-policy-map-name";
                                } // END of attached-policy-map-name definition.

                                leaf service-policy-type  {
                                    type  leafref {
                                        path  "../config/service-policy-type";
                                    }
                                    description "Use this attribute to specify service-policy-type";
                                } // END of service-policy-type definition.

                                container config {
                                    description
                                        "config";
                                    uses flowspec-vrf-service-policy_config;
                                } // END of config-container definition.
                                container state {
                                    config false;
                                    description
                                        "Operational state data for FLOWSPEC vrf service-policy config";
                                    uses flowspec-vrf-service-policy_config;
                                } // END of state-container definition.
                            } // End of service-policy-list
                            container config {
                                description
                                    "config";
                                uses flowspec-vrf-address-family_config;
                            } // END of config-container definition.
                            container state {
                                config false;
                                description
                                    "Operational state data for FLOWSPEC vrf address-family config";
                                uses flowspec-vrf-address-family_config;
                            } // END of state-container definition.
                        } // End of address-family-list
                    } // END of address-families-container definition.
                } // End of vrf-list
            } // END of vrfs-container definition.
        } // End of controller-list
    } // END of flowspec-top definition.
    grouping flowspec-controllers-top {
        description
            "Top-level grouping for FLOWSPEC";
        container controllers {
            description
                "Configuration data for controllers FLOWSPEC";
            uses flowspec-top;
        } // END of controllers-container definition.
    } // END of flowspec-controllers-top definition.

    grouping  flowspec-grouping {
    description
        "BGP Flow Specification (FLOWSPEC)";
    container flowspec {
        if-feature feature-list:HAVE_BGP_FLOWSPEC;
        if-feature feature-list:HAVE_BGPD;
        description
            "BGP Flow Specification (FLOWSPEC)";
        uses flowspec-controllers-top;
    } // END of flowspec-container definition.
    } // END of flowspec-grouping definition.


}